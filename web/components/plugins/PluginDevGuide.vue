<template>
  <n-modal v-model:show="visible" :mask-closable="false" preset="card" :style="{ maxWidth: '900px', width: '95%', maxHeight: '90vh' }" title="æ’ä»¶å¼€å‘è¯´æ˜">
    <div class="space-y-6 overflow-auto" style="max-height: calc(90vh - 120px);">
      <!-- æ’ä»¶æ¦‚è¿° -->
      <section>
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
          <i class="fas fa-info-circle text-blue-500 mr-2"></i>
          æ’ä»¶æ¦‚è¿°
        </h3>
        <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4">
          <p class="text-sm text-gray-700 dark:text-gray-300">
            URLDB æ’ä»¶ç³»ç»Ÿå…è®¸å¼€å‘è€…åˆ›å»ºè‡ªå®šä¹‰åŠŸèƒ½æ¨¡å—ï¼Œé€šè¿‡ JavaScript é’©å­å‡½æ•°ç›‘å¬ç³»ç»Ÿäº‹ä»¶ï¼Œæ‰©å±•ç³»ç»Ÿèƒ½åŠ›ã€‚
            æ’ä»¶å¯ä»¥ç›‘å¬ç”¨æˆ·ç™»å½•ã€URLæ·»åŠ ã€URLè®¿é—®ç­‰äº‹ä»¶ï¼Œå¹¶æ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘ã€‚
          </p>
        </div>
      </section>

      <!-- æ”¯æŒçš„äº‹ä»¶é’©å­ -->
      <section>
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
          <i class="fas fa-hooks text-green-500 mr-2"></i>
          æ”¯æŒçš„äº‹ä»¶é’©å­
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">onURLAdd</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">å½“æ–°URLè¢«æ·»åŠ æ—¶è§¦å‘</p>
            <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-2 rounded overflow-x-auto"><code>onURLAdd(function(event) {
    log("info", "æ–°URLæ·»åŠ : " + event.url.url, "my_plugin");
    // event.url åŒ…å«å®Œæ•´çš„URLä¿¡æ¯
});</code></pre>
          </div>

          <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">onURLAccess</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">å½“URLè¢«è®¿é—®æ—¶è§¦å‘</p>
            <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-2 rounded overflow-x-auto"><code>onURLAccess(function(event) {
    log("info", "URLè®¿é—®: " + event.url.url, "my_plugin");
    // event.url, event.request, event.response
});</code></pre>
          </div>

          <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">onUserLogin</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">å½“ç”¨æˆ·ç™»å½•æ—¶è§¦å‘</p>
            <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-2 rounded overflow-x-auto"><code>onUserLogin(function(event) {
    log("info", "ç”¨æˆ·ç™»å½•: " + event.user.username, "my_plugin");
    // event.user åŒ…å«ç”¨æˆ·ä¿¡æ¯
});</code></pre>
          </div>

          <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">onReadyResourceAdd</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">å½“å¾…å¤„ç†èµ„æºæ·»åŠ æ—¶è§¦å‘</p>
            <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-2 rounded overflow-x-auto"><code>onReadyResourceAdd(function(event) {
    log("info", "å¾…å¤„ç†èµ„æºæ·»åŠ : " + event.ready_resource.url, "my_plugin");
    // event.data åŒ…å«é¢å¤–ä¿¡æ¯ï¼Œå¦‚ is_filtered, filter_reason ç­‰
    if (event.data.is_filtered) {
        log("info", "èµ„æºè¢«è¿‡æ»¤: " + event.data.filter_reason, "my_plugin");
    }
});</code></pre>
          </div>

          <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">å®šæ—¶ä»»åŠ¡</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">å®šæ—¶æ‰§è¡Œçš„ä»»åŠ¡</p>
            <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-2 rounded overflow-x-auto"><code>cronAdd("task_name", "*/5 * * * *", function() {
    log("info", "å®šæ—¶ä»»åŠ¡æ‰§è¡Œ", "my_plugin");
});</code></pre>
          </div>
        </div>
      </section>

      <!-- æ’ä»¶ç»“æ„ -->
      <section>
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
          <i class="fas fa-file-code text-purple-500 mr-2"></i>
          æ’ä»¶æ–‡ä»¶ç»“æ„
        </h3>
        <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
          <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">æ’ä»¶æ–‡ä»¶ä½¿ç”¨ <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">.plugin.js</code> æ‰©å±•åï¼ŒåŸºäº JavaScript å¼€å‘ã€‚</p>

          <h4 class="font-medium text-gray-900 dark:text-white mb-2">åŸºæœ¬ç»“æ„ç¤ºä¾‹ï¼š</h4>
          <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto"><code>/**
 * æ’ä»¶å…ƒä¿¡æ¯ - ä½¿ç”¨ JSDoc æ³¨é‡Šæ ¼å¼
 *
 * @name my_plugin
 * @display_name æˆ‘çš„æ’ä»¶
 * @author å¼€å‘è€…å§“å
 * @description æ’ä»¶åŠŸèƒ½æè¿°
 * @version 1.0.0
 * @category utility
 * @license MIT
 */

// è®°å½•æ’ä»¶åŠ è½½æ—¥å¿—
log("info", "æ’ä»¶å·²åŠ è½½", "my_plugin");

// ç›‘å¬ URL æ·»åŠ äº‹ä»¶
onURLAdd(function(event) {
    log("info", "=== onURLAdd äº‹ä»¶è§¦å‘ ===", "my_plugin");
    log("info", "URL: " + event.url.url, "my_plugin");
    log("info", "æ ‡é¢˜: " + event.url.title, "my_plugin");

    // è‡ªå®šä¹‰é€»è¾‘
    if (event.url.url.includes("github.com")) {
        log("info", "æ£€æµ‹åˆ°GitHub URL", "my_plugin");
    }
});

// æ·»åŠ è‡ªå®šä¹‰è·¯ç”±
routerAdd("GET", "/api/my-endpoint", function(event) {
    return event.json(200, {
        success: true,
        message: "æˆ‘çš„æ’ä»¶è¿è¡Œæ­£å¸¸",
        timestamp: new Date().toISOString()
    });
});

// æ·»åŠ å®šæ—¶ä»»åŠ¡
cronAdd("cleanup_task", "0 2 * * *", function() {
    log("info", "æ‰§è¡Œæ¸…ç†ä»»åŠ¡", "my_plugin");
});

log("info", "æ’ä»¶åˆå§‹åŒ–å®Œæˆ", "my_plugin");</code></pre>
        </div>
      </section>

      <!-- å‹ç¼©åŒ…æ’ä»¶å¼€å‘ -->
      <section>
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
          <i class="fas fa-file-archive text-cyan-500 mr-2"></i>
          å‹ç¼©åŒ…æ’ä»¶å¼€å‘
        </h3>
        <div class="bg-cyan-50 dark:bg-cyan-900/20 border border-cyan-200 dark:border-cyan-800 rounded-lg p-4">
          <p class="text-sm text-gray-700 dark:text-gray-300 mb-4">
            å‹ç¼©åŒ…æ’ä»¶å…è®¸åˆ›å»ºæ›´å¤æ‚çš„å¤šæ–‡ä»¶æ’ä»¶ï¼ŒåŒ…å«å¤šä¸ª JavaScript æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ã€é™æ€èµ„æºç­‰ã€‚
          </p>

          <h4 class="font-medium text-gray-900 dark:text-white mb-2">å‹ç¼©åŒ…ç»“æ„ç¤ºä¾‹ï¼š</h4>
          <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto mb-4"><code>my-awesome-plugin.zip
â”œâ”€â”€ package.json              # æ’ä»¶é…ç½®æ–‡ä»¶
â”œâ”€â”€ index.js                  # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ utils.js             # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ processor.js         # æ•°æ®å¤„ç†å™¨
â”‚   â””â”€â”€ validator.js         # éªŒè¯å™¨
â”œâ”€â”€ config/
â”‚   â””â”€â”€ default.json         # é»˜è®¤é…ç½®
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ icon.png             # æ’ä»¶å›¾æ ‡
â”‚   â””â”€â”€ styles.css           # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ email.html           # é‚®ä»¶æ¨¡æ¿
â””â”€â”€ README.md                # è¯´æ˜æ–‡æ¡£</code></pre>

          <h4 class="font-medium text-gray-900 dark:text-white mb-2">package.json é…ç½®ç¤ºä¾‹ï¼š</h4>
          <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto mb-4"><code>{
  "name": "my-awesome-plugin",
  "version": "1.0.0",
  "description": "ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„æ’ä»¶",
  "main": "index.js",
  "author": "å¼€å‘è€…å§“å",
  "license": "MIT",
  "keywords": ["plugin", "automation", "utility"],
  "engines": {
    "urldb": ">=1.0.0"
  },
  "config": {
    "webhook_url": {
      "type": "string",
      "label": "Webhook URL",
      "default": "https://hooks.slack.com/...",
      "description": "é€šçŸ¥å‘é€çš„Webhookåœ°å€"
    },
    "enable_notifications": {
      "type": "boolean",
      "label": "å¯ç”¨é€šçŸ¥",
      "default": true
    },
    "retry_count": {
      "type": "number",
      "label": "é‡è¯•æ¬¡æ•°",
      "default": 3,
      "min": 1,
      "max": 10
    }
  },
  "dependencies": {},
  "permissions": [
    "network",
    "storage"
  ]
}</code></pre>

          <h4 class="font-medium text-gray-900 dark:text-white mb-2">å‹ç¼©åŒ…æ’ä»¶ä¼˜åŠ¿ï¼š</h4>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <div class="bg-white dark:bg-gray-800 rounded p-3">
              <h5 class="font-medium text-gray-900 dark:text-white mb-1">ğŸ“ æ¨¡å—åŒ–å¼€å‘</h5>
              <p class="text-xs text-gray-600 dark:text-gray-400">å¯ä»¥å°†ä»£ç æ‹†åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œä¾¿äºç»´æŠ¤å’Œæµ‹è¯•</p>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded p-3">
              <h5 class="font-medium text-gray-900 dark:text-white mb-1">ğŸ¨ èµ„æºç®¡ç†</h5>
              <p class="text-xs text-gray-600 dark:text-gray-400">å¯ä»¥åŒ…å«å›¾æ ‡ã€æ ·å¼ã€æ¨¡æ¿ç­‰é™æ€èµ„æº</p>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded p-3">
              <h5 class="font-medium text-gray-900 dark:text-white mb-1">âš™ï¸ é…ç½®çµæ´»</h5>
              <p class="text-xs text-gray-600 dark:text-gray-400">é€šè¿‡ package.json å®šä¹‰å¤æ‚çš„é…ç½®é€‰é¡¹</p>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded p-3">
              <h5 class="font-medium text-gray-900 dark:text-white mb-1">ğŸ”§ ä¾èµ–ç®¡ç†</h5>
              <p class="text-xs text-gray-600 dark:text-gray-400">æ”¯æŒæ¨¡å—é—´çš„ä¾èµ–å…³ç³»å’Œä»£ç å¤ç”¨</p>
            </div>
          </div>
        </div>
      </section>

      <!-- æ•°æ®åº“è¿ç§»åŠŸèƒ½ -->
      <section>
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
          <i class="fas fa-database text-teal-500 mr-2"></i>
          æ•°æ®åº“è¿ç§» (migrate) åŠŸèƒ½
        </h3>
        <div class="bg-teal-50 dark:bg-teal-900/20 border border-teal-200 dark:border-teal-800 rounded-lg p-4">
          <p class="text-sm text-gray-700 dark:text-gray-300 mb-4">
            Hook ç±»å‹æ’ä»¶ï¼ˆå•æ–‡ä»¶ .plugin.jsï¼‰ä¸æ”¯æŒ migrate åŠŸèƒ½ï¼Œåªæœ‰å‹ç¼©åŒ…æ’ä»¶æ”¯æŒé€šè¿‡ SQL æ–‡ä»¶è¿›è¡Œæ•°æ®åº“ç»“æ„è¿ç§»ã€‚
            åœ¨å‹ç¼©åŒ…æ’ä»¶ä¸­ï¼Œmigrate åŠŸèƒ½é€šè¿‡ migrate/ ç›®å½•ä¸‹çš„ install.sql å’Œ uninstall.sql æ–‡ä»¶å®ç°ã€‚
          </p>

          <h4 class="font-medium text-gray-900 dark:text-white mb-2">ğŸ“‹ migrate è§„åˆ™è¯´æ˜ï¼š</h4>
          <div class="space-y-3 mb-4">
            <div class="bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded p-3">
              <h5 class="font-medium text-red-800 dark:text-red-200 mb-1">âŒ Hook æ’ä»¶ (å•æ–‡ä»¶ .plugin.js)</h5>
              <ul class="text-sm text-red-700 dark:text-red-300 space-y-1">
                <li>â€¢ ä¸æ”¯æŒ migrate åŠŸèƒ½</li>
                <li>â€¢ æ— æ³•ä½¿ç”¨ migrate() å‡½æ•°æˆ– SQL è¿ç§»æ–‡ä»¶</li>
                <li>â€¢ é€‚åˆç®€å•çš„é€»è¾‘å¤„ç†æ’ä»¶</li>
              </ul>
            </div>
            <div class="bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded p-3">
              <h5 class="font-medium text-green-800 dark:text-green-200 mb-1">âœ… å‹ç¼©åŒ…æ’ä»¶</h5>
              <ul class="text-sm text-green-700 dark:text-green-300 space-y-1">
                <li>â€¢ æ”¯æŒ SQL è¿ç§»æ–‡ä»¶ (install.sql, uninstall.sql)</li>
                <li>â€¢ è‡ªåŠ¨æ‰§è¡Œå®‰è£…/å¸è½½è¿ç§»</li>
                <li>â€¢ é€‚åˆéœ€è¦æ•°æ®åº“ç»“æ„çš„å¤æ‚æ’ä»¶</li>
              </ul>
            </div>
          </div>

          <h4 class="font-medium text-gray-900 dark:text-white mb-2">ğŸ—‚ï¸ å‹ç¼©åŒ…æ’ä»¶ migrate ç›®å½•ç»“æ„ï¼š</h4>
          <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto mb-4"><code>my-migration-plugin.zip
â”œâ”€â”€ package.json              # æ’ä»¶é…ç½®æ–‡ä»¶
â”œâ”€â”€ index.js                  # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ migrate/                  # è¿ç§»ç›®å½•
â”‚   â”œâ”€â”€ install.sql          # å®‰è£…æ—¶æ‰§è¡Œçš„SQL
â”‚   â””â”€â”€ uninstall.sql        # å¸è½½æ—¶æ‰§è¡Œçš„SQL
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ utils.js
â””â”€â”€ README.md</code></pre>

          <h4 class="font-medium text-gray-900 dark:text-white mb-2">ğŸ“„ SQL æ–‡ä»¶è§„èŒƒï¼š</h4>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-4">
            <div class="bg-white dark:bg-gray-800 rounded p-3">
              <h5 class="font-medium text-gray-900 dark:text-white mb-1">install.sql</h5>
              <ul class="text-xs text-gray-600 dark:text-gray-400 space-y-1">
                <li>â€¢ æ’ä»¶å®‰è£…æ—¶è‡ªåŠ¨æ‰§è¡Œ</li>
                <li>â€¢ åˆ›å»ºè¡¨ã€ç´¢å¼•ç­‰ç»“æ„</li>
                <li>â€¢ æ’å…¥åˆå§‹æ•°æ®</li>
                <li>â€¢ æ‰§è¡Œå¤±è´¥ä¼šå›æ»šå®‰è£…</li>
              </ul>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded p-3">
              <h5 class="font-medium text-gray-900 dark:text-white mb-1">uninstall.sql</h5>
              <ul class="text-xs text-gray-600 dark:text-gray-400 space-y-1">
                <li>â€¢ æ’ä»¶å¸è½½æ—¶è‡ªåŠ¨æ‰§è¡Œ</li>
                <li>â€¢ åˆ é™¤ç›¸å…³è¡¨ç»“æ„</li>
                <li>â€¢ æ¸…ç†æ’ä»¶æ•°æ®</li>
                <li>â€¢ ç¡®ä¿ç³»ç»Ÿå¹²å‡€å¸è½½</li>
              </ul>
            </div>
          </div>

          <h4 class="font-medium text-gray-900 dark:text-white mb-2">ğŸ“ install.sql ç¤ºä¾‹ï¼š</h4>
          <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto mb-4"><code>-- åˆ›å»ºæ’ä»¶æ•°æ®è¡¨
CREATE TABLE IF NOT EXISTS my_plugin_data (
    id INTEGER PRIMARY KEY,
    plugin_name VARCHAR(100) NOT NULL,
    message TEXT,
    config_json TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX IF NOT EXISTS idx_my_plugin_data_name
ON my_plugin_data(plugin_name);

-- æ’å…¥åˆå§‹æ•°æ®
INSERT INTO my_plugin_data (plugin_name, message, config_json)
VALUES ('my_plugin', 'æ’ä»¶å®‰è£…æ—¶åˆ›å»ºçš„é»˜è®¤æ•°æ®', '{"enabled": true, "version": "1.0.0"}');</code></pre>

          <h4 class="font-medium text-gray-900 dark:text-white mb-2">ğŸ“ uninstall.sql ç¤ºä¾‹ï¼š</h4>
          <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto mb-4"><code>-- åˆ é™¤ç´¢å¼•
DROP INDEX IF EXISTS idx_my_plugin_data_name;

-- åˆ é™¤æ’ä»¶æ•°æ®è¡¨
DROP TABLE IF EXISTS my_plugin_data;</code></pre>

          <h4 class="font-medium text-gray-900 dark:text-white mb-2">âš ï¸ é”™è¯¯å¤„ç†ï¼š</h4>
          <div class="bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded p-3">
            <ul class="text-sm text-yellow-800 dark:text-yellow-200 space-y-1">
              <li>â€¢ <strong>å®‰è£…å¤±è´¥ï¼š</strong> install.sql æ‰§è¡Œå¤±è´¥æ—¶ï¼Œæ’ä»¶å®‰è£…ä¼šè¢«å›æ»š</li>
              <li>â€¢ <strong>å¸è½½å¤±è´¥ï¼š</strong> uninstall.sql æ‰§è¡Œå¤±è´¥ä¼šè®°å½•é”™è¯¯æ—¥å¿—ï¼Œä½†ä¸ä¼šé˜»æ­¢å¸è½½</li>
              <li>â€¢ <strong>SQL è¯­æ³•ï¼š</strong> è¯·ç¡®ä¿ SQL è¯­æ³•å…¼å®¹å½“å‰æ•°æ®åº“ (PostgreSQL/MySQL/SQLite)</li>
              <li>â€¢ <strong>äº‹åŠ¡å®‰å…¨ï¼š</strong> æ¯ä¸ª SQL æ–‡ä»¶éƒ½åœ¨ç‹¬ç«‹äº‹åŠ¡ä¸­æ‰§è¡Œ</li>
            </ul>
          </div>

          <h4 class="font-medium text-gray-900 dark:text-white mb-2">ğŸ’¡ æœ€ä½³å®è·µï¼š</h4>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <div class="bg-white dark:bg-gray-800 rounded p-3">
              <h5 class="font-medium text-gray-900 dark:text-white mb-1">ğŸ”§ å‘½åè§„èŒƒ</h5>
              <ul class="text-xs text-gray-600 dark:text-gray-400 space-y-1">
                <li>â€¢ è¡¨åä½¿ç”¨æ’ä»¶å‰ç¼€ï¼šplugin_name_table</li>
                <li>â€¢ ç´¢å¼•ååŒ…å«è¡¨åï¼šidx_table_field</li>
                <li>â€¢ é¿å…ä¸ç³»ç»Ÿè¡¨åå†²çª</li>
              </ul>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded p-3">
              <h5 class="font-medium text-gray-900 dark:text-white mb-1">ğŸ›¡ï¸ å®‰å…¨è€ƒè™‘</h5>
              <ul class="text-xs text-gray-600 dark:text-gray-400 space-y-1">
                <li>â€¢ ä½¿ç”¨ IF EXISTS é¿å…é”™è¯¯</li>
                <li>â€¢ ä¸åˆ é™¤ç³»ç»Ÿè¡¨æˆ–æ•°æ®</li>
                <li>â€¢ åªæ“ä½œæ’ä»¶ç›¸å…³æ•°æ®</li>
              </ul>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded p-3">
              <h5 class="font-medium text-gray-900 dark:text-white mb-1">ğŸ“Š æ€§èƒ½ä¼˜åŒ–</h5>
              <ul class="text-xs text-gray-600 dark:text-gray-400 space-y-1">
                <li>â€¢ åˆç†åˆ›å»ºç´¢å¼•</li>
                <li>â€¢ é¿å…å¤§é‡æ•°æ®æ’å…¥</li>
                <li>â€¢ ä½¿ç”¨æ‰¹é‡æ“ä½œ</li>
              </ul>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded p-3">
              <h5 class="font-medium text-gray-900 dark:text-white mb-1">ğŸ§ª æµ‹è¯•å»ºè®®</h5>
              <ul class="text-xs text-gray-600 dark:text-gray-400 space-y-1">
                <li>â€¢ åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ SQL</li>
                <li>â€¢ æµ‹è¯•å®‰è£…å’Œå¸è½½æµç¨‹</li>
                <li>â€¢ éªŒè¯æ•°æ®å®Œæ•´æ€§</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- å¯ç”¨API -->
      <section>
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
          <i class="fas fa-cogs text-orange-500 mr-2"></i>
          å¯ç”¨ API
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">æ—¥å¿—å‡½æ•°</h4>
            <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">log(level, message, pluginName)</code> - è®°å½•æ—¥å¿—</li>
              <li>level: "debug", "info", "warn", "error"</li>
              <li>æ—¥å¿—ä¼šä¿å­˜åˆ°æ•°æ®åº“ï¼Œå¯åœ¨ç®¡ç†ç•Œé¢æŸ¥çœ‹</li>
            </ul>
          </div>

          <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">è·¯ç”±å‡½æ•°</h4>
            <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">routerAdd(method, path, handler)</code> - æ·»åŠ è‡ªå®šä¹‰è·¯ç”±</li>
            </ul>
          </div>

          <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">å®šæ—¶ä»»åŠ¡</h4>
            <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">cronAdd(name, schedule, handler)</code> - æ·»åŠ å®šæ—¶ä»»åŠ¡</li>
              <li>schedule: Cron è¡¨è¾¾å¼ (å¦‚ "*/5 * * * *")</li>
              <li>æ”¯æŒæ ‡å‡† Cron æ ¼å¼</li>
            </ul>
          </div>

          <div class="bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">é…ç½®ç®¡ç†</h4>
            <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">getPluginConfig(name)</code> - è·å–é…ç½®</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">setPluginConfig(name, config)</code> - è®¾ç½®é…ç½®</li>
              <li>é€šè¿‡ JSDoc @config å®šä¹‰é…ç½®å­—æ®µ</li>
              <li>æ”¯æŒå¤šç§å­—æ®µç±»å‹å’ŒéªŒè¯</li>
            </ul>
          </div>

          <div class="bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">æ•°æ®åº“æ“ä½œ (db)</h4>
            <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">db.find(table, conditions)</code> - æŸ¥è¯¢è®°å½•</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">db.save(table, data)</code> - ä¿å­˜è®°å½•</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">db.update(table, id, data)</code> - æ›´æ–°è®°å½•</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">db.delete(table, id)</code> - åˆ é™¤è®°å½•</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">db.count(table, conditions)</code> - è®¡æ•°æŸ¥è¯¢</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">db.raw(sql, params)</code> - æ‰§è¡ŒåŸå§‹SQL</li>
            </ul>
          </div>

          <div class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">HTTPå®¢æˆ·ç«¯ (http)</h4>
            <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$http.get(url)</code> - GETè¯·æ±‚</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$http.post(url, body, options)</code> - POSTè¯·æ±‚</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$http.put(url, body, options)</code> - PUTè¯·æ±‚</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$http.delete(url)</code> - DELETEè¯·æ±‚</li>
            </ul>
          </div>

          <div class="bg-cyan-50 dark:bg-cyan-900/20 border border-cyan-200 dark:border-cyan-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">æ–‡ä»¶ç³»ç»Ÿ (filesystem)</h4>
            <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$filesystem.readFile(path)</code> - è¯»å–æ–‡ä»¶</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$filesystem.writeFile(path, content)</code> - å†™å…¥æ–‡ä»¶</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$filesystem.fileExists(path)</code> - æ£€æŸ¥æ–‡ä»¶å­˜åœ¨</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$filesystem.fileSize(path)</code> - è·å–æ–‡ä»¶å¤§å°</li>
            </ul>
          </div>

          <div class="bg-pink-50 dark:bg-pink-900/20 border border-pink-200 dark:border-pink-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">å®‰å…¨å‡½æ•° (security)</h4>
            <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$security.md5(str)</code> - MD5å“ˆå¸Œ</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$security.sha256(str)</code> - SHA256å“ˆå¸Œ</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$security.randomString(length)</code> - éšæœºå­—ç¬¦ä¸²</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$security.createJWT(payload, secret, expire)</code> - åˆ›å»ºJWT</li>
              <li><code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">$security.parseJWT(token, secret)</code> - è§£æJWT</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- äº‹ä»¶å¯¹è±¡è¯¦æƒ… -->
      <section>
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
          <i class="fas fa-object-group text-indigo-500 mr-2"></i>
          äº‹ä»¶å¯¹è±¡è¯¦æƒ…
        </h3>
        <div class="space-y-3">
          <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">onURLAdd äº‹ä»¶å¯¹è±¡</h4>
            <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-2 rounded overflow-x-auto"><code>{
    url: {
        id: 156696,
        title: "URLæ ‡é¢˜",
        url: "https://example.com",
        description: "æè¿°",
        category_id: 1,
        tags: ["æ ‡ç­¾1", "æ ‡ç­¾2"],
        is_valid: true,
        is_public: true,
        view_count: 0,
        created_at: "2025-12-29T23:49:04.556Z"
    },
    data: {
        // é™„åŠ æ•°æ®
    },
    app: {
        name: "URLDB",
        version: "1.0.0"
    }
}</code></pre>
          </div>

          <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">onUserLogin äº‹ä»¶å¯¹è±¡</h4>
            <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-2 rounded overflow-x-auto"><code>{
    user: {
        id: 1,
        username: "admin",
        email: "admin@example.com",
        role: "admin",
        is_active: true,
        last_login: "2025-12-29T23:49:04.556Z",
        created_at: "2025-12-29T23:49:04.556Z"
    },
    data: {
        ip: "127.0.0.1",
        user_agent: "æµè§ˆå™¨ä¿¡æ¯",
        login_time: "2025-12-29T23:49:04.556Z"
    },
    app: {
        name: "URLDB",
        version: "1.0.0"
    }
}</code></pre>
          </div>

          <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">onURLAccess äº‹ä»¶å¯¹è±¡</h4>
            <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-2 rounded overflow-x-auto"><code>{
    url: {
        id: 156696,
        title: "URLæ ‡é¢˜",
        url: "https://example.com",
        description: "æè¿°",
        category_id: 1,
        tags: ["æ ‡ç­¾1", "æ ‡ç­¾2"],
        is_valid: true,
        is_public: true,
        view_count: 0,
        created_at: "2025-12-29T23:49:04.556Z"
    },
    access_log: {},
    request: {},
    response: {},
    app: {
        name: "URLDB",
        version: "1.0.0"
    }
}</code></pre>
          </div>

          <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 dark:text-white mb-2">onReadyResourceAdd äº‹ä»¶å¯¹è±¡</h4>
            <pre class="text-xs bg-gray-100 dark:bg-gray-900 p-2 rounded overflow-x-auto"><code>{
    ready_resource: {
        id: 1,
        key: "èµ„æºæ ‡è¯†",
        title: "èµ„æºæ ‡é¢˜",
        description: "èµ„æºæè¿°",
        url: "https://example.com",
        category: "åˆ†ç±»",
        tags: ["æ ‡ç­¾"],
        img: "å›¾ç‰‡URL",
        source: "æ¥æº",
        extra: "é™„åŠ ä¿¡æ¯",
        ip: "IPåœ°å€",
        error_msg: "é”™è¯¯ä¿¡æ¯",
        created_at: "2025-12-29T23:49:04.556Z"
    },
    data: {
        is_filtered: false,
        filter_reason: "è¿‡æ»¤åŸå› ", // å¦‚æœè¢«è¿‡æ»¤
        // å…¶ä»–é™„åŠ æ•°æ®
    },
    app: {
        name: "URLDB",
        version: "1.0.0"
    }
}</code></pre>
          </div>
        </div>
      </section>

      <!-- æœ€ä½³å®è·µ -->
      <section>
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
          <i class="fas fa-lightbulb text-yellow-500 mr-2"></i>
          æœ€ä½³å®è·µ
        </h3>
        <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4">
          <ul class="text-sm text-gray-700 dark:text-gray-300 space-y-2">
            <li class="flex items-start">
              <i class="fas fa-check text-green-500 mr-2 mt-0.5"></i>
              <span>ä½¿ç”¨æè¿°æ€§çš„æ’ä»¶åç§°å’Œå‡½æ•°å</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-green-500 mr-2 mt-0.5"></i>
              <span>åˆç†ä½¿ç”¨æ—¥å¿—çº§åˆ«ï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-green-500 mr-2 mt-0.5"></i>
              <span>é”™è¯¯å¤„ç†è¦å®Œå–„ï¼Œé¿å…æ’ä»¶å¼‚å¸¸å½±å“ç³»ç»Ÿ</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-green-500 mr-2 mt-0.5"></i>
              <span>å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶é—´ä¸å®œè¿‡é•¿</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-green-500 mr-2 mt-0.5"></i>
              <span>æ’ä»¶è·¯ç”±ä½¿ç”¨æœ‰æ„ä¹‰çš„å‰ç¼€ï¼Œé¿å…å†²çª</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-green-500 mr-2 mt-0.5"></i>
              <span>æä¾›è¯¦ç»†çš„æ’ä»¶æè¿°å’Œé…ç½®è¯´æ˜</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-green-500 mr-2 mt-0.5"></i>
              <span>éªŒè¯æ‰€æœ‰å¤–éƒ¨è¾“å…¥ï¼Œé˜²æ­¢æ³¨å…¥æ”»å‡»</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-green-500 mr-2 mt-0.5"></i>
              <span>é¿å…åœ¨é«˜é¢‘äº‹ä»¶ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-green-500 mr-2 mt-0.5"></i>
              <span>åŠæ—¶æ¸…ç†ä¸´æ—¶æ–‡ä»¶å’Œèµ„æº</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-green-500 mr-2 mt-0.5"></i>
              <span>ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢SQLæ³¨å…¥</span>
            </li>
          </ul>
        </div>
      </section>

      <!-- è°ƒè¯•æŠ€å·§ -->
      <section>
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center">
          <i class="fas fa-bug text-red-500 mr-2"></i>
          è°ƒè¯•æŠ€å·§
        </h3>
        <div class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4">
          <ul class="text-sm text-gray-700 dark:text-gray-300 space-y-2">
            <li class="flex items-start">
              <i class="fas fa-tools text-red-500 mr-2 mt-0.5"></i>
              <span>ä½¿ç”¨ <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">log("debug", message, pluginName)</code> è®°å½•è°ƒè¯•ä¿¡æ¯</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-tools text-red-500 mr-2 mt-0.5"></i>
              <span>åœ¨æ’ä»¶ç®¡ç†ç•Œé¢æŸ¥çœ‹å®æ—¶æ—¥å¿—è¾“å‡º</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-tools text-red-500 mr-2 mt-0.5"></i>
              <span>æ’ä»¶æ”¯æŒçƒ­é‡è½½ï¼Œä¿®æ”¹åè‡ªåŠ¨ç”Ÿæ•ˆ</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-tools text-red-500 mr-2 mt-0.5"></i>
              <span>å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯æ’ä»¶åŠŸèƒ½</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-tools text-red-500 mr-2 mt-0.5"></i>
              <span>å‹ç¼©åŒ…æ’ä»¶å¯ä»¥é€šè¿‡è§£å‹æŸ¥çœ‹æ–‡ä»¶ç»“æ„è¿›è¡Œè°ƒè¯•</span>
            </li>
          </ul>
        </div>
      </section>
    </div>

    <template #footer>
      <div class="flex justify-between">
        <n-button @click="goToPluginManager" type="info" v-if="showPluginManagerButton">
          <template #icon>
            <i class="fas fa-plug"></i>
          </template>
          å‰å¾€æ’ä»¶ç®¡ç†
        </n-button>
        <div></div>
        <n-button @click="closeModal" type="primary">
          æˆ‘çŸ¥é“äº†
        </n-button>
      </div>
    </template>
  </n-modal>
</template>

<script setup lang="ts">
interface Props {
  modelValue: boolean
  showPluginManagerButton?: boolean
}

const props = withDefaults(defineProps<Props>(), {
  showPluginManagerButton: true
})

const emit = defineEmits<{
  'update:modelValue': [value: boolean]
  'go-to-plugin-manager': []
}>()

const visible = computed({
  get: () => props.modelValue,
  set: (value) => emit('update:modelValue', value)
})

const closeModal = () => {
  emit('update:modelValue', false)
}

const goToPluginManager = () => {
  emit('go-to-plugin-manager')
  closeModal()
}
</script>