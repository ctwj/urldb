# æ’ä»¶ç®¡ç†ç³»ç»Ÿéƒ¨ç½²æŒ‡å—

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### 1. åç«¯éƒ¨ç½² âœ…

#### ç¼–è¯‘å’Œè¿è¡Œ
```bash
# 1. æ¸…ç†ç¼“å­˜
go clean -cache

# 2. æ•´ç†ä¾èµ–
go mod tidy

# 3. ç¼–è¯‘é¡¹ç›®
go build -o urldb .

# 4. å¯åŠ¨æœåŠ¡
./urldb
```

#### éªŒè¯APIæ¥å£
```bash
# æµ‹è¯•æ’ä»¶åˆ—è¡¨API
curl http://localhost:8080/api/plugins

# æµ‹è¯•æ’ä»¶ç»Ÿè®¡API
curl http://localhost:8080/api/plugins/stats

# æµ‹è¯•æ’ä»¶è¯¦æƒ…API
curl http://localhost:8080/api/plugins/config_demo
```

### 2. å‰ç«¯éƒ¨ç½² âš ï¸

#### ç›®å½•ç»“æ„è°ƒæ•´
å½“å‰Vueç»„ä»¶åˆ›å»ºåœ¨æ ¹ç›®å½•ï¼Œéœ€è¦ç§»åŠ¨åˆ°æ­£ç¡®çš„Nuxt 3é¡¹ç›®ç»“æ„ï¼š

```bash
# åˆ›å»ºæ­£ç¡®çš„ç›®å½•ç»“æ„ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
mkdir -p web/components/plugins
mkdir -p web/pages/admin
mkdir -p web/composables

# ç§»åŠ¨Vueç»„ä»¶åˆ°æ­£ç¡®ä½ç½®
mv components/plugins/*.vue web/components/plugins/
mv pages/admin/*.vue web/pages/admin/
mv composables/*.js web/composables/

# éªŒè¯æ–‡ä»¶ç»“æ„
find web -name "*.vue" -path "*/plugins/*"
find web -name "*.vue" -path "*/admin/*"
```

#### å®‰è£…ä¾èµ–å’Œæ„å»º
```bash
cd web

# å®‰è£…ä¾èµ–
npm install

# æ„å»ºé¡¹ç›®
npm run build

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

## ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•

### åç«¯æ£€æŸ¥ âœ…
- [ ] ç¼–è¯‘æ— é”™è¯¯
- [ ] æ•°æ®åº“è¿ç§»æˆåŠŸ
- [ ] APIæ¥å£æ­£å¸¸å“åº”
- [ ] æ’ä»¶ç›®å½•å­˜åœ¨
- [ ] æ—¥å¿—ç³»ç»Ÿæ­£å¸¸

### å‰ç«¯æ£€æŸ¥ âš ï¸
- [ ] ç›®å½•ç»“æ„è°ƒæ•´å®Œæˆ
- [ ] ä¾èµ–å®‰è£…æˆåŠŸ
- [ ] æ„å»ºæ— é”™è¯¯
- [ ] é¡µé¢æ­£å¸¸è®¿é—®
- [ ] APIè°ƒç”¨æ­£å¸¸

### åŠŸèƒ½æµ‹è¯• âœ…
- [ ] æ’ä»¶åˆ—è¡¨æ˜¾ç¤º
- [ ] æ’ä»¶è¯¦æƒ…æŸ¥çœ‹
- [ ] æ’ä»¶å¯åœæ§åˆ¶
- [ ] æ’ä»¶é…ç½®ç®¡ç†
- [ ] æ—¥å¿—æŸ¥çœ‹åŠŸèƒ½

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### 1. å‰ç«¯ç»„ä»¶æ‰¾ä¸åˆ°
**é—®é¢˜**: Vueç»„ä»¶æ— æ³•æ­£ç¡®åŠ è½½
**è§£å†³**:
```bash
# æ£€æŸ¥ç»„ä»¶æ˜¯å¦åœ¨æ­£ç¡®ç›®å½•
ls -la web/components/plugins/
ls -la web/pages/admin/

# æ£€æŸ¥Nuxté…ç½®
cat web/nuxt.config.ts | grep -A 5 -B 5 components
```

### 2. APIè°ƒç”¨å¤±è´¥
**é—®é¢˜**: å‰ç«¯æ— æ³•è°ƒç”¨åç«¯API
**è§£å†³**:
```bash
# æ£€æŸ¥åç«¯æœåŠ¡çŠ¶æ€
curl http://localhost:8080/api/plugins/stats

# æ£€æŸ¥CORSé…ç½®
curl -H "Origin: http://localhost:3000" http://localhost:8080/api/plugins
```

### 3. æ’ä»¶æ–‡ä»¶ä¸å­˜åœ¨
**é—®é¢˜**: æ’ä»¶ç›®å½•æˆ–æ–‡ä»¶ç¼ºå¤±
**è§£å†³**:
```bash
# æ£€æŸ¥æ’ä»¶ç›®å½•
ls -la hooks/

# åˆ›å»ºæµ‹è¯•æ’ä»¶
./urldb plugin create test_plugin hook

# éªŒè¯æ’ä»¶
./urldb plugin validate hooks/test_plugin.pb.js
```

### 4. æ•°æ®åº“è¡¨ä¸å­˜åœ¨
**é—®é¢˜**: æ’ä»¶ç›¸å…³è¡¨æœªåˆ›å»º
**è§£å†³**:
```bash
# æ£€æŸ¥æ•°æ®åº“è¿æ¥
psql -h localhost -U postgres -d urldb

# æŸ¥çœ‹æ’ä»¶ç›¸å…³è¡¨
\dt plugin_*

# æ‰‹åŠ¨åˆ›å»ºè¡¨ï¼ˆå¦‚æœéœ€è¦ï¼‰
# GORMä¼šè‡ªåŠ¨åˆ›å»ºï¼Œç¡®ä¿æ•°æ®åº“è¿ç§»æ­£å¸¸è¿è¡Œ
```

## ğŸŒ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### 1. ç¯å¢ƒé…ç½®
```bash
# å¤åˆ¶ç¯å¢ƒé…ç½®
cp .env.example .env

# ç¼–è¾‘ç”Ÿäº§é…ç½®
vim .env
```

å…³é”®é…ç½®é¡¹ï¼š
```bash
# æ•°æ®åº“é…ç½®
DB_HOST=your-db-host
DB_PORT=5432
DB_USER=urldb
DB_PASSWORD=your-password
DB_NAME=urldb

# æœåŠ¡å™¨é…ç½®
PORT=8080
GIN_MODE=release
ENV=production

# æ’ä»¶ç³»ç»Ÿé…ç½®
PLUGIN_ENABLED=true
PLUGIN_DEBUG=false
PLUGIN_VM_POOL_SIZE=10
```

### 2. è¿›ç¨‹ç®¡ç†
```bash
# ä½¿ç”¨systemdç®¡ç†æœåŠ¡
sudo cp scripts/urldb.service /etc/systemd/system/
sudo systemctl enable urldb
sudo systemctl start urldb

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status urldb
```

### 3. åå‘ä»£ç†é…ç½®
```nginx
# Nginxé…ç½®ç¤ºä¾‹
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### 1. æ—¥å¿—ç›‘æ§
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f logs/urldb.log

# æŸ¥çœ‹æ’ä»¶æ—¥å¿—
tail -f logs/plugin.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep ERROR logs/urldb.log
```

### 2. æ€§èƒ½ç›‘æ§
```bash
# æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨
top -p $(pgrep urldb)

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
ps aux | grep urldb

# æŸ¥çœ‹ç½‘ç»œè¿æ¥
netstat -tlnp | grep :8080
```

### 3. æ’ä»¶å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥æ’ä»¶çŠ¶æ€
curl http://localhost:8080/api/plugins/stats

# æ£€æŸ¥æ’ä»¶æ—¥å¿—
curl http://localhost:8080/api/plugins/config_demo/logs?limit=5
```

## ğŸ”„ å¤‡ä»½å’Œæ¢å¤

### 1. æ•°æ®å¤‡ä»½
```bash
# å¤‡ä»½æ•°æ®åº“
pg_dump -h localhost -U postgres urldb > backup_$(date +%Y%m%d).sql

# å¤‡ä»½æ’ä»¶æ–‡ä»¶
tar -czf plugins_backup_$(date +%Y%m%d).tar.gz hooks/

# å¤‡ä»½é…ç½®æ–‡ä»¶
cp .env .env.backup
```

### 2. æ•°æ®æ¢å¤
```bash
# æ¢å¤æ•°æ®åº“
psql -h localhost -U postgres urldb < backup_20241225.sql

# æ¢å¤æ’ä»¶æ–‡ä»¶
tar -xzf plugins_backup_20241225.tar.gz

# æ¢å¤é…ç½®
cp .env.backup .env
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### å¸¸ç”¨å‘½ä»¤
```bash
# æ’ä»¶ç®¡ç†
./urldb plugin list
./urldb plugin stats
./urldb plugin validate hooks/config_demo.pb.js

# ç³»ç»Ÿä¿¡æ¯
./urldb version
./urldb plugin --help

# è°ƒè¯•æ¨¡å¼
PLUGIN_DEBUG=true ./urldb
```

### æ—¥å¿—ä½ç½®
- åº”ç”¨æ—¥å¿—: `logs/urldb.log`
- æ’ä»¶æ—¥å¿—: `logs/plugin.log`
- é”™è¯¯æ—¥å¿—: `logs/error.log`
- è®¿é—®æ—¥å¿—: `logs/access.log`

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æ›´æ–°æ—¶é—´**: 2024-12-25
**çŠ¶æ€**: âœ… å¯ç”¨äºç”Ÿäº§éƒ¨ç½²