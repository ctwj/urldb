# URLDB æ’ä»¶ç³»ç»Ÿå¼€å‘æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [æ’ä»¶ç³»ç»Ÿæ¦‚è¿°](#æ’ä»¶ç³»ç»Ÿæ¦‚è¿°)
2. [æ’ä»¶ç±»å‹](#æ’ä»¶ç±»å‹)
3. [æ’ä»¶ç›®å½•ç»“æ„](#æ’ä»¶ç›®å½•ç»“æ„)
4. [æ’ä»¶å¼€å‘åŸºç¡€](#æ’ä»¶å¼€å‘åŸºç¡€)
5. [ç³»ç»Ÿäº‹ä»¶ä¸é’©å­](#ç³»ç»Ÿäº‹ä»¶ä¸é’©å­)
6. [å¯ç”¨çš„APIä¸ç»‘å®š](#å¯ç”¨çš„apiä¸ç»‘å®š)
7. [æ’ä»¶é…ç½®](#æ’ä»¶é…ç½®)
8. [è·¯ç”±ä¸æ¥å£å¼€å‘](#è·¯ç”±ä¸æ¥å£å¼€å‘)
9. [å®šæ—¶ä»»åŠ¡](#å®šæ—¶ä»»åŠ¡)
10. [æ–‡ä»¶æ“ä½œ](#æ–‡ä»¶æ“ä½œ)
11. [æ•°æ®åº“æ“ä½œ](#æ•°æ®åº“æ“ä½œ)
12. [å®‰å…¨ä¸éªŒè¯](#å®‰å…¨ä¸éªŒè¯)
13. [é”™è¯¯å¤„ç†ä¸æ—¥å¿—](#é”™è¯¯å¤„ç†ä¸æ—¥å¿—)
14. [éƒ¨ç½²ä¸ç®¡ç†](#éƒ¨ç½²ä¸ç®¡ç†)

---

## æ’ä»¶ç³»ç»Ÿæ¦‚è¿°

URLDBæ’ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºJavaScript/Gojaçš„å¯æ‰©å±•æ¶æ„ï¼Œå…è®¸å¼€å‘è€…æ‰©å±•ç³»ç»ŸåŠŸèƒ½ã€‚æ’ä»¶é€šè¿‡äº‹ä»¶é’©å­ã€è‡ªå®šä¹‰è·¯ç”±ã€å®šæ—¶ä»»åŠ¡ç­‰æ–¹å¼ä¸ä¸»ç³»ç»Ÿé›†æˆã€‚

### æ ¸å¿ƒç‰¹æ€§
- **äº‹ä»¶é©±åŠ¨**: é€šè¿‡ç³»ç»Ÿäº‹ä»¶é’©å­å“åº”ç³»ç»Ÿå˜åŒ–
- **çƒ­é‡è½½**: æ”¯æŒæ’ä»¶æ–‡ä»¶ä¿®æ”¹åè‡ªåŠ¨é‡è½½
- **æ²™ç®±æ‰§è¡Œ**: JavaScriptä»£ç åœ¨å®‰å…¨æ²™ç®±ä¸­æ‰§è¡Œ
- **ç±»å‹æç¤º**: æ”¯æŒTypeScriptç±»å‹æç¤º

### æ’ä»¶ç³»ç»Ÿæ¶æ„
- **æ’ä»¶ç›®å½•**: `plugin-system/hooks/`
- **ç±»å‹å®šä¹‰**: `plugin-system/types/`
- **è¿ç§»æ–‡ä»¶**: `migrations/`

---

## æ’ä»¶ç±»å‹

### 1. é’©å­æ’ä»¶ (Hook Plugins)

é’©å­æ’ä»¶æ˜¯ä»¥ `.plugin.js` ç»“å°¾çš„JavaScriptæ–‡ä»¶ï¼Œç›´æ¥æ”¾ç½®åœ¨ `plugin-system/hooks/` ç›®å½•ä¸‹ã€‚

#### åˆ›å»ºé’©å­æ’ä»¶
```javascript
/// <reference path="../pb_data/types.d.ts" />

/**
 * æ’ä»¶åç§°: my_plugin
 * æ˜¾ç¤ºåç§°: æˆ‘çš„æ’ä»¶
 * ä½œè€…: å¼€å‘è€…å§“å
 * ç‰ˆæœ¬: 1.0.0
 * æè¿°: æ’ä»¶åŠŸèƒ½æè¿°
 *
 * @config
 * @field {string} webhook_url Webhook URL "Webhooké€šçŸ¥åœ°å€" @default "https://example.com/webhook"
 * @field {boolean} enable_notification å¯ç”¨é€šçŸ¥ "æ˜¯å¦å¯ç”¨é€šçŸ¥åŠŸèƒ½" @default true
 * @config
 */
```

### 2. å‹ç¼©åŒ…æ’ä»¶ (Package Plugins)

å‹ç¼©åŒ…æ’ä»¶æ˜¯å®Œæ•´çš„æ’ä»¶åŒ…æ ¼å¼ï¼Œé€‚ç”¨äºå¤æ‚çš„æ’ä»¶é¡¹ç›®ã€‚

#### åˆ›å»ºå‹ç¼©åŒ…æ’ä»¶
å‹ç¼©åŒ…æ’ä»¶éœ€è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ç»“æ„ï¼š
```
my_plugin.zip
â”œâ”€â”€ package.json              # æ’ä»¶é…ç½®æ–‡ä»¶
â”œâ”€â”€ hooks/                    # é’©å­æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ my_hook.plugin.js
â”‚   â””â”€â”€ another_hook.plugin.js
â””â”€â”€ migrate/                  # æ•°æ®åº“è¿ç§»ç›®å½• (å¯é€‰)
    â”œâ”€â”€ install.sql
    â””â”€â”€ uninstall.sql
```

#### package.json é…ç½®
```json
{
  "name": "my_complex_plugin",
  "version": "1.0.0",
  "description": "ä¸€ä¸ªå¤æ‚çš„æ’ä»¶ç¤ºä¾‹",
  "author": "å¼€å‘è€…å§“å",
  "main": "index.js",
  "hooks": ["my_hook.plugin.js"],
  "dependencies": [],
  "config": {
    "enabled": true
  }
}
```

---

## æ’ä»¶ç›®å½•ç»“æ„

```
urldb/
â”œâ”€â”€ plugin-system/
â”‚   â”œâ”€â”€ hooks/                 # æ’ä»¶æ–‡ä»¶å­˜æ”¾ç›®å½•
â”‚   â”‚   â”œâ”€â”€ my_plugin.plugin.js
â”‚   â”‚   â””â”€â”€ config_demo.plugin.js
â”‚   â””â”€â”€ types/                 # TypeScriptç±»å‹å®šä¹‰
â”‚       â””â”€â”€ types.d.ts
â”œâ”€â”€ migrations/               # æ•°æ®åº“è¿ç§»æ–‡ä»¶ï¼ˆç³»ç»Ÿçº§ï¼‰
â””â”€â”€ main.go                  # ä¸»ç¨‹åºå…¥å£
```

---

## æ’ä»¶å¼€å‘åŸºç¡€

### æ’ä»¶æ–‡ä»¶å‘½å

- **é’©å­æ’ä»¶**: ä½¿ç”¨ `.plugin.js` åç¼€
- **ç¤ºä¾‹**: `my_plugin.plugin.js`

### æ’ä»¶å¤´éƒ¨æ³¨é‡Š

```javascript
/// <reference path="../pb_data/types.d.ts" />

/**
 * my_plugin é’©å­
 * åˆ›å»ºæ—¶é—´: 2026-01-05 10:00:00
 *
 * @name my_plugin
 * @display_name æˆ‘çš„æ’ä»¶
 * @author URLDBå¼€å‘å›¢é˜Ÿ
 * @description æ’ä»¶åŠŸèƒ½æè¿°
 * @version 1.0.0
 * @category demo
 * @license MIT
 *
 * @config
 * @field {string} webhook_url Webhook URL "é€šçŸ¥å‘é€çš„Webhookåœ°å€" @default "https://hooks.example.com"
 * @field {boolean} enable_notification å¯ç”¨é€šçŸ¥ "æ˜¯å¦å¯ç”¨é€šçŸ¥åŠŸèƒ½" @default true
 * @config
 */
```

---

## ç³»ç»Ÿäº‹ä»¶ä¸é’©å­

### äº‹ä»¶ç±»å‹

æ’ä»¶å¯ä»¥é€šè¿‡äº‹ä»¶é’©å­å“åº”ç³»ç»Ÿäº‹ä»¶ï¼š

#### 1. URLç›¸å…³äº‹ä»¶

```javascript
// URLæ·»åŠ äº‹ä»¶
onURLAdd(function(event) {
    console.log("URLæ·»åŠ :", event.url.id, event.url.title);
    // å¤„ç†é€»è¾‘
});

// URLè®¿é—®äº‹ä»¶
onURLAccess(function(event) {
    console.log("URLè®¿é—®:", event.url.id);
    // å¤„ç†é€»è¾‘
});

// URLæ›´æ–°äº‹ä»¶
onURLUpdate(function(event) {
    console.log("URLæ›´æ–°:", event.url.id);
    // å¤„ç†é€»è¾‘
});

// URLåˆ é™¤äº‹ä»¶
onURLDelete(function(event) {
    console.log("URLåˆ é™¤:", event.url.id);
    // å¤„ç†é€»è¾‘
});
```

#### 2. ç”¨æˆ·ç›¸å…³äº‹ä»¶

```javascript
// ç”¨æˆ·ç™»å½•äº‹ä»¶
onUserLogin(function(event) {
    console.log("ç”¨æˆ·ç™»å½•:", event.user.username);
    // å¤„ç†é€»è¾‘
});

// ç”¨æˆ·ç™»å‡ºäº‹ä»¶
onUserLogout(function(event) {
    console.log("ç”¨æˆ·ç™»å‡º:", event.user.username);
    // å¤„ç†é€»è¾‘
});

// ç”¨æˆ·æ³¨å†Œäº‹ä»¶
onUserRegister(function(event) {
    console.log("ç”¨æˆ·æ³¨å†Œ:", event.user.username);
    // å¤„ç†é€»è¾‘
});
```

#### 3. åˆ†ç±»ä¸æ ‡ç­¾äº‹ä»¶

```javascript
// åˆ†ç±»åˆ›å»ºäº‹ä»¶
onCategoryCreate(function(event) {
    console.log("åˆ†ç±»åˆ›å»º:", event.category.name);
    // å¤„ç†é€»è¾‘
});

// æ ‡ç­¾æ·»åŠ äº‹ä»¶
onTagAdd(function(event) {
    console.log("æ ‡ç­¾æ·»åŠ :", event.tag.name);
    // å¤„ç†é€»è¾‘
});
```

#### 4. APIç›¸å…³äº‹ä»¶

```javascript
// APIè¯·æ±‚äº‹ä»¶
onAPIRequest(function(event) {
    console.log("APIè¯·æ±‚:", event.method, event.path);
    // å¤„ç†é€»è¾‘
});

// APIå“åº”äº‹ä»¶
onAPIResponse(function(event) {
    console.log("APIå“åº”:", event.method, event.path, event.status);
    // å¤„ç†é€»è¾‘
});
```

#### 5. å¾…å¤„ç†èµ„æºäº‹ä»¶

```javascript
// å¾…å¤„ç†èµ„æºæ·»åŠ äº‹ä»¶
onReadyResourceAdd(function(event) {
    console.log("å¾…å¤„ç†èµ„æºæ·»åŠ :", event.ready_resource.url);
    // event.data åŒ…å«é¢å¤–ä¿¡æ¯ï¼Œå¦‚ is_filtered, filter_reason ç­‰
    if (event.data.is_filtered) {
        console.log("èµ„æºè¢«è¿‡æ»¤:", event.data.filter_reason);
    }
    // å¤„ç†é€»è¾‘
});
```

---

## å¯ç”¨çš„APIä¸ç»‘å®š

### 1. æ•°æ®åº“æ“ä½œ (db)

```javascript
// æŸ¥è¯¢èµ„æº - ä½¿ç”¨å¯¹è±¡å½¢å¼çš„æŸ¥è¯¢æ¡ä»¶
const resources = db.find("resources", { category: "tech" });

// è·å–è®°å½•æ•°é‡
const count = db.count("resources", { category: "tech" });

// æ‰§è¡ŒåŸå§‹SQL - æ”¯æŒå‚æ•°åŒ–æŸ¥è¯¢
const result = db.raw("SELECT id, title, url FROM resources WHERE category = $1", ["tech"]);

// ä¿å­˜è®°å½• - æ•°æ®åº”ä¸ºå¯¹è±¡
const newResource = {
    title: "æ–°èµ„æº",
    url: "http://example.com",
    category: "tech",
    description: "è¿™æ˜¯ä¸€ä¸ªæ–°èµ„æº"
};
const saved = db.save("resources", newResource);

// æ›´æ–°è®°å½•
const updated = db.update("resources", saved.id, {
    title: "æ›´æ–°åçš„æ ‡é¢˜"
});

// åˆ é™¤è®°å½•
const deleted = db.delete("resources", resourceId);

// å¤æ‚æŸ¥è¯¢ç¤ºä¾‹
const complexResult = db.raw(`
    SELECT r.id, r.title, r.url, c.name as category_name
    FROM resources r
    LEFT JOIN categories c ON r.category_id = c.id
    WHERE r.category = $1
    ORDER BY r.created_at DESC
    LIMIT $2
`, ["technology", 10]);
```

### 2. å®‰å…¨å‡½æ•° (security)

```javascript
// å“ˆå¸Œè¿ç®—
const md5Hash = $security.md5("string");
const sha256Hash = $security.sha256("string");
const sha512Hash = $security.sha512("string");

// éšæœºå­—ç¬¦ä¸²ç”Ÿæˆ
const randomStr = $security.randomString(16);

// JWTæ“ä½œ
const token = $security.createJWT(
    { user_id: 123, exp: Date.now() + 3600000 }, // 1å°æ—¶è¿‡æœŸ
    "secret_key",
    3600
);
const payload = $security.parseJWT(token, "secret_key");

// åŠ å¯†è§£å¯†
const encrypted = $security.encrypt("Hello World", "key");
const decrypted = $security.decrypt(encrypted, "key");
```

### 3. æ“ä½œç³»ç»Ÿå‡½æ•° (os)

```javascript
// ç¯å¢ƒå˜é‡
const path = $os.getenv("PATH");
const home = $os.getenv("HOME");

// ä¸´æ—¶ç›®å½•
const tempDir = $os.tempDir();

// å¹³å°ä¿¡æ¯
const platform = $os.platform();
const args = $os.args();
```

### 4. æ–‡ä»¶ç³»ç»Ÿæ“ä½œ (filesystem)

```javascript
// è¯»å–æ–‡ä»¶
const content = $filesystem.readFile("/path/to/file.txt");

// å†™å…¥æ–‡ä»¶
$filesystem.writeFile("/path/to/file.txt", "Hello World");

// æ–‡ä»¶å­˜åœ¨æ£€æŸ¥
const exists = $filesystem.fileExists("/path/to/file.txt");

// æ–‡ä»¶å¤§å°
const size = $filesystem.fileSize("/path/to/file.txt");
```

### 5. æ–‡ä»¶è·¯å¾„æ“ä½œ (filepath)

```javascript
// è·¯å¾„æ“ä½œ
const joined = $filepath.join("path", "to", "file.txt");
const base = $filepath.base("/path/to/file.txt");
const dir = $filepath.dir("/path/to/file.txt");
const ext = $filepath.ext("/path/to/file.txt");
const isAbs = $filepath.isAbs("/path/to/file.txt");
const clean = $filepath.clean("path//to///./file.txt");
```

### 6. è¡¨å•éªŒè¯ (forms)

```javascript
const data = {
    name: "ç”¨æˆ·",
    email: "user@example.com",
    age: 25
};

const rules = {
    name: { required: true, minLength: 2, maxLength: 50 },
    email: { required: true, isEmail: true },
    age: { required: true, min: 18, max: 120 }
};

const result = $forms.validate(data, rules);
if (result.valid) {
    // éªŒè¯é€šè¿‡
} else {
    // éªŒè¯å¤±è´¥ï¼Œresult.errors åŒ…å«é”™è¯¯ä¿¡æ¯
}
```

### 7. HTTPå®¢æˆ·ç«¯ (http)

```javascript
// GETè¯·æ±‚
const getResponse = $http.get("https://api.example.com/data");

// POSTè¯·æ±‚
const postResponse = $http.post("https://api.example.com/data", {
    key: "value"
}, {
    headers: { "Content-Type": "application/json" }
});

// è‡ªå®šä¹‰è¯·æ±‚
const customResponse = $http.send("PUT", "https://api.example.com/data", {
    body: JSON.stringify({ key: "value" }),
    headers: { "Content-Type": "application/json" }
});
```

### 8. é‚®ä»¶å‘é€ (mails)

```javascript
// å‘é€é‚®ä»¶
const result = mails.send(
    "recipient@example.com",
    "é‚®ä»¶ä¸»é¢˜",
    "é‚®ä»¶å†…å®¹",
    {
        from: "sender@example.com",
        cc: ["cc@example.com"],
        attachments: ["/path/to/attachment.pdf"]
    }
);
```

---

## æ’ä»¶é…ç½®

### é…ç½®å£°æ˜

åœ¨æ’ä»¶å¤´éƒ¨æ³¨é‡Šä¸­ä½¿ç”¨ `@config` æ ‡ç­¾å£°æ˜é…ç½®ï¼š

```javascript
/**
 * @config
 * @field {string} webhook_url Webhook URL "Webhooké€šçŸ¥åœ°å€" @default "https://hooks.example.com"
 * @field {boolean} enable_notification å¯ç”¨é€šçŸ¥ "æ˜¯å¦å¯ç”¨é€šçŸ¥åŠŸèƒ½" @default true
 * @field {number} retry_count é‡è¯•æ¬¡æ•° "å¤±è´¥é‡è¯•æ¬¡æ•°" @default 3
 * @field {select} log_level æ—¥å¿—çº§åˆ« ["debug", "info", "warn", "error"] @default "info"
 * @field {text} custom_message è‡ªå®šä¹‰æ¶ˆæ¯ "è‡ªå®šä¹‰é€šçŸ¥æ¶ˆæ¯" @optional @default "é»˜è®¤æ¶ˆæ¯"
 * @config
 */
```

### é…ç½®ç±»å‹

1. **string**: å­—ç¬¦ä¸²è¾“å…¥
2. **number**: æ•°å­—è¾“å…¥
3. **boolean**: å¸ƒå°”å€¼ï¼ˆå¤é€‰æ¡†ï¼‰
4. **select**: ä¸‹æ‹‰é€‰æ‹©
5. **text**: å¤šè¡Œæ–‡æœ¬
6. **password**: å¯†ç è¾“å…¥

### è·å–é…ç½®

```javascript
// è·å–æ’ä»¶é…ç½®
const config = getPluginConfig("my_plugin");

if (config) {
    console.log("Webhook URL:", config.webhook_url);
    console.log("é€šçŸ¥å¯ç”¨:", config.enable_notification);
    console.log("é‡è¯•æ¬¡æ•°:", config.retry_count);
}
```

### è®¾ç½®é…ç½®

```javascript
// è®¾ç½®æ’ä»¶é…ç½®
setPluginConfig("my_plugin", {
    webhook_url: "https://new-webhook.example.com",
    enable_notification: true,
    retry_count: 5
});
```

---

## è·¯ç”±ä¸æ¥å£å¼€å‘

### æ·»åŠ è‡ªå®šä¹‰è·¯ç”±

```javascript
// GETè·¯ç”±
routerAdd("GET", "/api/my-endpoint", (e) => {
    return e.json(200, {
        message: "Hello from custom endpoint",
        timestamp: new Date().toISOString()
    });
});

// POSTè·¯ç”±
routerAdd("POST", "/api/my-endpoint", (e) => {
    const body = e.body; // è·å–è¯·æ±‚ä½“
    const headers = e.headers; // è·å–è¯·æ±‚å¤´
    const query = e.query; // è·å–æŸ¥è¯¢å‚æ•°

    return e.json(200, {
        message: "POST received",
        data: body
    });
});

// å¸¦å‚æ•°çš„è·¯ç”±
routerAdd("GET", "/api/my-endpoint/:id", (e) => {
    const id = e.params.id; // è·å–è·¯å¾„å‚æ•°

    return e.json(200, {
        message: "Item ID: " + id
    });
});
```

### è·¯ç”±å¤„ç†å‡½æ•°

è·¯ç”±å¤„ç†å‡½æ•°æ¥æ”¶ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ `e`ï¼ŒåŒ…å«ä»¥ä¸‹å±æ€§ï¼š

- `e.body`: è¯·æ±‚ä½“ï¼ˆPOST/PUTç­‰ï¼‰
- `e.headers`: è¯·æ±‚å¤´
- `e.query`: æŸ¥è¯¢å‚æ•°
- `e.params`: è·¯å¾„å‚æ•°
- `e.json(status, data)`: è¿”å›JSONå“åº”

---

## å®šæ—¶ä»»åŠ¡

### æ·»åŠ å®šæ—¶ä»»åŠ¡

```javascript
// ä½¿ç”¨Cronè¡¨è¾¾å¼æ·»åŠ å®šæ—¶ä»»åŠ¡
// æ¯åˆ†é’Ÿæ‰§è¡Œ: "*/1 * * * *"
// æ¯å°æ—¶æ‰§è¡Œ: "0 * * * *"
// æ¯å¤©å‡Œæ™¨2ç‚¹: "0 2 * * *"
// æ¯å‘¨æ—¥å‡Œæ™¨3ç‚¹: "0 3 * * 0"

cronAdd("my_task", "*/5 * * * *", () => {
    console.log("å®šæ—¶ä»»åŠ¡æ‰§è¡Œ:", new Date().toISOString());

    try {
        // ä½ çš„ä»»åŠ¡é€»è¾‘
        const config = getPluginConfig("my_plugin");

        if (config && config.enable_notification) {
            // æ‰§è¡Œå®šæœŸä»»åŠ¡
            console.log("æ‰§è¡Œå‘¨æœŸæ€§æ£€æŸ¥...");
        }
    } catch (error) {
        console.error("å®šæ—¶ä»»åŠ¡æ‰§è¡Œå¤±è´¥:", error.message);
    }
});
```

### ç§»é™¤å®šæ—¶ä»»åŠ¡

```javascript
// ç§»é™¤å®šæ—¶ä»»åŠ¡
cronRemove("my_task");
```

---

## æ–‡ä»¶æ“ä½œ

### è¯»å†™æ–‡ä»¶

```javascript
// å†™å…¥æ–‡ä»¶
const filePath = $os.tempDir() + "/my_file.txt";
$filesystem.writeFile(filePath, "Hello World");

// è¯»å–æ–‡ä»¶
const content = $filesystem.readFile(filePath);
console.log("æ–‡ä»¶å†…å®¹:", content);

// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
if ($filesystem.fileExists(filePath)) {
    console.log("æ–‡ä»¶å­˜åœ¨");
}

// è·å–æ–‡ä»¶å¤§å°
const size = $filesystem.fileSize(filePath);
console.log("æ–‡ä»¶å¤§å°:", size);
```

### ç›®å½•æ“ä½œ

```javascript
// åˆ›å»ºç›®å½•
const dirPath = $os.tempDir() + "/my_dir";
$os.createDir(dirPath);

// åˆ—å‡ºç›®å½•å†…å®¹
const files = $filesystem.readdir(dirPath);
console.log("ç›®å½•å†…å®¹:", files);
```

---

## æ•°æ®åº“æ“ä½œ

### æŸ¥è¯¢æ“ä½œ

```javascript
// ç®€å•æŸ¥è¯¢
const resources = db.find("resources", {});

// æ¡ä»¶æŸ¥è¯¢
const techResources = db.find("resources", {
    category: "technology"
});

// é™åˆ¶ç»“æœæ•°é‡
const recentResources = db.find("resources", {}, {
    limit: 10,
    order: "created_at DESC"
});

// è®¡æ•°æŸ¥è¯¢
const total = db.count("resources", {
    category: "technology"
});
```

### ä¿å­˜æ“ä½œ

```javascript
// ä¿å­˜æ–°è®°å½•
const newResource = {
    title: "æ–°èµ„æº",
    url: "http://example.com",
    category: "technology",
    description: "è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹èµ„æº"
};
const saved = db.save("resources", newResource);

// æ›´æ–°è®°å½•
const updated = db.update("resources", saved.id, {
    title: "æ›´æ–°åçš„æ ‡é¢˜"
});
```

### åŸå§‹SQLæŸ¥è¯¢

```javascript
// æ‰§è¡ŒåŸå§‹SQLæŸ¥è¯¢
const result = db.raw(`
    SELECT id, title, url
    FROM resources
    WHERE category = $1
    ORDER BY created_at DESC
    LIMIT $2
`, ["technology", 10]);

// æ‰§è¡Œæ›´æ–°è¯­å¥
const updateResult = db.raw(`
    UPDATE resources
    SET updated_at = NOW()
    WHERE id = $1
`, [resourceId]);
```

---

## å®‰å…¨ä¸éªŒè¯

### è¾“å…¥éªŒè¯

```javascript
// ä½¿ç”¨è¡¨å•éªŒè¯
const validationRules = {
    email: { required: true, isEmail: true },
    username: {
        required: true,
        minLength: 3,
        maxLength: 20,
        pattern: "^[a-zA-Z0-9_]+$" // åªå…è®¸å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿
    },
    age: { required: true, min: 18, max: 120 }
};

const data = {
    email: "user@example.com",
    username: "testuser",
    age: 25
};

const validationResult = $forms.validate(data, validationRules);

if (validationResult.valid) {
    console.log("éªŒè¯é€šè¿‡");
} else {
    console.log("éªŒè¯å¤±è´¥:", validationResult.errors);
}
```

### å®‰å…¨å“ˆå¸Œ

```javascript
// ç”Ÿæˆå®‰å…¨å“ˆå¸Œ
const passwordHash = $security.sha256(password + salt);
const fileHash = $security.md5(fileContent);

// ç”Ÿæˆéšæœºå­—ç¬¦ä¸²
const token = $security.randomString(32);
const apiKey = $security.randomString(64);
```

### JWTä»¤ç‰Œ

```javascript
// åˆ›å»ºJWTä»¤ç‰Œ
const token = $security.createJWT(
    {
        user_id: 123,
        username: "testuser",
        exp: Math.floor(Date.now() / 1000) + 3600 // 1å°æ—¶åè¿‡æœŸ
    },
    "your-secret-key",
    3600 // è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
);

// éªŒè¯JWTä»¤ç‰Œ
try {
    const payload = $security.parseJWT(token, "your-secret-key");
    console.log("ç”¨æˆ·ID:", payload.user_id);
} catch (error) {
    console.error("ä»¤ç‰ŒéªŒè¯å¤±è´¥:", error.message);
}
```

---

## é”™è¯¯å¤„ç†ä¸æ—¥å¿—

### é”™è¯¯å¤„ç†

```javascript
// ä½¿ç”¨try-catchå¤„ç†é”™è¯¯
try {
    const result = someRiskyOperation();
    console.log("æ“ä½œæˆåŠŸ:", result);
} catch (error) {
    console.error("æ“ä½œå¤±è´¥:", error.message);
    // è®°å½•è¯¦ç»†é”™è¯¯ä¿¡æ¯
    console.error("é”™è¯¯å †æ ˆ:", error.stack);
}
```

### æ—¥å¿—è®°å½•

```javascript
// ä½¿ç”¨æ—¥å¿—å‡½æ•°è®°å½•ä¿¡æ¯
log("debug", "è°ƒè¯•ä¿¡æ¯");
log("info", "ä¸€èˆ¬ä¿¡æ¯");
log("warn", "è­¦å‘Šä¿¡æ¯");
log("error", "é”™è¯¯ä¿¡æ¯");

// å¸¦æ’ä»¶åç§°çš„æ—¥å¿—
log("info", "æ’ä»¶æ¶ˆæ¯å†…å®¹", "plugin_name");

// è®°å½•æ’ä»¶ç‰¹å®šä¿¡æ¯
const config = getPluginConfig("my_plugin");
if (config && config.log_level === "debug") {
    log("debug", "è¯¦ç»†è°ƒè¯•ä¿¡æ¯");
}
```

---

## éƒ¨ç½²ä¸ç®¡ç†

### æ’ä»¶éƒ¨ç½²

1. **æ–‡ä»¶ä½ç½®**: å°†æ’ä»¶æ–‡ä»¶æ”¾ç½®åœ¨ `plugin-system/hooks/` ç›®å½•ä¸‹
2. **æ–‡ä»¶æ ¼å¼**: ç¡®ä¿æ–‡ä»¶åä»¥ `.plugin.js` ç»“å°¾
3. **é‡å¯ç³»ç»Ÿ**: æ’ä»¶ä¼šåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½
4. **çƒ­é‡è½½**: ä¿®æ”¹æ’ä»¶æ–‡ä»¶åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é‡æ–°åŠ è½½

### æ’ä»¶å¯ç”¨/ç¦ç”¨

```javascript
// é€šè¿‡APIæ¥å£ç®¡ç†æ’ä»¶çŠ¶æ€
// é€šè¿‡HTTPè¯·æ±‚æˆ–ç®¡ç†ç•Œé¢æ§åˆ¶æ’ä»¶å¯ç”¨çŠ¶æ€
```

### æ’ä»¶ç®¡ç†API

ç³»ç»Ÿæä¾›ä»¥ä¸‹APIç”¨äºæ’ä»¶ç®¡ç†ï¼š

- `GET /api/plugins`: è·å–æ‰€æœ‰æ’ä»¶åˆ—è¡¨
- `GET /api/plugins/:name`: è·å–ç‰¹å®šæ’ä»¶ä¿¡æ¯
- `POST /api/plugins/:name/enable`: å¯ç”¨æ’ä»¶
- `POST /api/plugins/:name/disable`: ç¦ç”¨æ’ä»¶
- `PUT /api/plugins/:name/config`: æ›´æ–°æ’ä»¶é…ç½®

### æœ€ä½³å®è·µ

1. **é”™è¯¯å¤„ç†**: å§‹ç»ˆä½¿ç”¨try-catchåŒ…è£…å¯èƒ½å‡ºé”™çš„ä»£ç 
2. **æ—¥å¿—è®°å½•**: è®°å½•é‡è¦æ“ä½œå’Œé”™è¯¯ä¿¡æ¯
3. **æ€§èƒ½ä¼˜åŒ–**: é¿å…åœ¨é«˜é¢‘äº‹ä»¶ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ
4. **å®‰å…¨æ€§**: éªŒè¯æ‰€æœ‰å¤–éƒ¨è¾“å…¥ï¼Œé¿å…æ³¨å…¥æ”»å‡»
5. **èµ„æºç®¡ç†**: åŠæ—¶æ¸…ç†ä¸´æ—¶æ–‡ä»¶å’Œèµ„æº

## é™„å½•

### Cronè¡¨è¾¾å¼è¯­æ³•

| å­—æ®µ | å–å€¼ | è¯´æ˜ |
|------|------|------|
| åˆ†é’Ÿ | 0-59 | |
| å°æ—¶ | 0-23 | |
| æ—¥æœŸ | 1-31 | |
| æœˆä»½ | 1-12 | |
| æ˜ŸæœŸ | 0-7 | 0å’Œ7éƒ½è¡¨ç¤ºå‘¨æ—¥ |

**ç¤ºä¾‹**:
- `*/5 * * * *` - æ¯5åˆ†é’Ÿæ‰§è¡Œ
- `0 2 * * *` - æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œ
- `0 0 * * 0` - æ¯å‘¨æ—¥å‡Œæ™¨æ‰§è¡Œ

### å¸¸è§é—®é¢˜

1. **æ’ä»¶ä¸åŠ è½½**: æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦ä»¥`.plugin.js`ç»“å°¾
2. **APIè·¯ç”±å†²çª**: ç¡®ä¿è·¯ç”±è·¯å¾„å”¯ä¸€
3. **æ€§èƒ½é—®é¢˜**: é¿å…åœ¨äº‹ä»¶é’©å­ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ
4. **é…ç½®ä¸ç”Ÿæ•ˆ**: æ£€æŸ¥é…ç½®å£°æ˜æ ¼å¼æ˜¯å¦æ­£ç¡®

### å®‰å…¨å»ºè®®

1. **è¾“å…¥éªŒè¯**: å§‹ç»ˆéªŒè¯ç”¨æˆ·è¾“å…¥
2. **SQLæ³¨å…¥é˜²æŠ¤**: ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
3. **æ–‡ä»¶è·¯å¾„éªŒè¯**: é¿å…è·¯å¾„éå†æ”»å‡»
4. **APIè®¿é—®æ§åˆ¶**: å®æ–½é€‚å½“çš„è®¿é—®æ§åˆ¶